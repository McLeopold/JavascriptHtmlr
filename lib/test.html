<!DOCTYPE html>
<html>
  <head lang="en">
    <meta charset="utf-8" />
    <title>test</title>
  </head>
  <body>
    <div id="spot"></div>
    <script src="htmlr.js"></script>
    <script>
    var spot = document.getElementById('spot');    
    
    /* testing */
    var test1a = function (count, remove) {
      if (remove === undefined || count > 1) {
        remove = true;
      }
      for (var i = count; i > 0; --i) {
	    with (Htmlr) {
	      var data_table = (
	        table({border: 1, cellpadding: 4},
	          thead(extract('fields')(
	            tr(each()(
	              th('{0}')
	            ))
	          )),
	          tbody(extract('values')(each()(
	            tr(each()(
	              td('{0}')
	            ))
	          ))),
	          tfoot
	        )
	      );
	    };
	    var data = {
	      fields: ['id', 'name'],
	      values: [[1, 'scott'],
	               [2, 'mike']]
	    };
	    // console.log(data_table.display(0, data));
	    var table = data_table.renderDOM(data);
	    spot.appendChild(table);
	    if (remove) {
          spot.removeChild(table);
	    }
      }
    };
    // test1a(1, false);

    var test1b = function (count, remove) {
      if (remove === undefined || count > 1) {
        remove = true;
      }
      for (var i = count; i > 0; --i) {
        with (Htmlr) {
          var data_table = (
            table({border: 1, cellpadding: 4},
              thead(extract('fields')(
                tr(each()(
                  th('{0}')
                ))
              )),
              tbody(extract('values')(each()(
                tr(each()(
                  td('{0}')
                ))
              ))),
              tfoot
            )
          );
        };
        var data = {
          fields: ['id', 'name'],
          values: [[1, 'scott'],
                   [2, 'mike']]
        };
        // console.log(data_table.display(0, data));
        var table = data_table.render(data);
        spot.innerHTML = table;
        if (remove) {
          spot.innerHTML = "";
        }
      }
    };
    // test1b(1, false);
    
    var test2 = function () {
	    with (Htmlr) {
	      var data_list = ul(each()(li('{0}')));
	    }
	    spot.appendChild(data_list.renderDOM(data.fields));
	    
	    with (Htmlr) {
	      var data2_table = (
	        table({border: 1, cellpadding: 4},
	          thead(extract(0)(
	            tr(each()(
	              th('{key}')
	            ))
	          )),
	          tbody(each()(
	            tr(each()(
	              td('{value}')
	            ))
	          ))
	        )
	      );
	    };
	    var data2 = [{id: 1, name: 'scott'},
	                 {id: 2, name: 'mike'}];
	    // console.log(data2_table.display(0, data2));
	    spot.appendChild(data2_table.renderDOM(data2));
    };
    
    var test3 = function () {
	    with (Htmlr) {
	      var data_form = (
	        form({class: 'my_form'},
	          'Enter Name: ', text({name: 'one', value: '{name}'}), br,
	          'Select Age: ', select(
	            each(2, 35)(
	                option({selected: 'selected'}, '{0}')
	            ),
	            option(15)
	          )
	        )
	      );
	    }
	    var data3 = {name: 'scott', age: 35};
	    // console.log(data_form.display(0, data3));
	    spot.appendChild(data_form.renderDOM(data3));
    };
    
    var test4 = function () {
      with (Htmlr) {
        var template = doctype(
          html(
            head({lang: 'en'},
              meta({charset: 'utf-8'}),
              title('{title}'),
              css('style.css'),
              javascript('script.js')
            ),
            body(
              h1("Hello World!"),
              comment("woot!"),
              div({id: 'content'}, '{content}')
            )
          )
        );
      }
      var data = {title: "My Title", content: "My Content"};
      var pre = document.createElement('pre');
      pre.appendChild(document.createTextNode(template.render(data)));
      spot.appendChild(pre);    
    };
    test4();
    
    </script>
  </body>
</html>